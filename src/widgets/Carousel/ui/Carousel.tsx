import { classNames } from 'shared/lib/classNames';
import Flower from 'shared/assets/icons/flower.svg'
import FlowerMobile from 'shared/assets/icons/flower_mobile.svg';
import { Swiper, SwiperSlide } from 'swiper/react';
import { A11y, Pagination, Autoplay, Navigation } from 'swiper/modules';
import { isMobile } from 'react-device-detect';
import FirstSlide from 'shared/assets/img/slide_1.png';
import SecondSlide from 'shared/assets/img/slide_2.png';
import ThirdSlide from 'shared/assets/img/slide_3.png';
import FourthSlide from 'shared/assets/img/slide_4.png';

import cls from './Carousel.module.scss';

import 'swiper/css';
import 'swiper/css/pagination';
import 'swiper/css/navigation';
import { motion } from 'framer-motion';
import { useMemo, useState } from 'react';
import { useDebounce } from 'shared/lib/useDebounce';
import { Bg } from 'shared/ui/Bg/Bg';


const slides = [
  {
    id: 1,
    titleText: 'Встретиться с экспертами и медийными личностями',
    img: FirstSlide,
    color: 'purple'
  },
  {
    id: 2,
    titleText: 'Поучаствовать в спортивных активностях на природе',
    img: SecondSlide,
    color: 'orange'
  },
  {
    id: 3,
    titleText: 'Выступить на творческом вечере',
    img: ThirdSlide,
    color: 'lightGreen'
  },
  {
    id: 4,
    titleText: 'Спеть любимые песни под гитару у костра',
    img: FourthSlide,
    color: 'cyan'
  },
]

export const Carousel = () => {
  const [test, setTest] = useState<number>(0);

  const getActiveSlides = useMemo(() => {
    return Array.from(Array(test + 1).keys())
  }, [test]);

  const handleSwipe = (swiper: any) => {
    if (swiper.realIndex !== test) {
      setTest(swiper.realIndex);
    }
  }
  const handleSwipeDebounce = useDebounce(handleSwipe, 200);

  return (
    <div className={classNames('container', {}, [cls.carousel])}>
      <Bg />
      <div className={'content'}>
        <div className={cls.header}>
          <h2 className={cls.title}>ты сможешь</h2>
          <motion.div animate={{ rotate: [90 * (test - 1), 90 * test] }} transition={{ duration: 1, ease: 'linear', type: 'spring' }} key={test}>
            <svg className={cls.flower} width="229" height="229" viewBox="0 0 229 229" fill="none" xmlns="http://www.w3.org/2000/svg">
              <g id="flower">
                <path id="Vector" d="M135.578 169.235L135.578 167.374C135.326 152.978 132.007 138.794 125.845 125.791C138.767 132.016 152.868 135.385 167.196 135.667C188.194 136.076 212.775 129.707 220.754 121.76C221.829 120.89 222.697 119.79 223.293 118.541C223.888 117.291 224.198 115.921 224.198 114.533C224.198 113.145 223.888 111.774 223.293 110.525C222.697 109.269 221.829 108.169 220.754 107.3C212.702 99.3528 188.157 92.9318 167.196 93.2831C152.871 93.5538 138.768 96.8881 125.826 103.067C132.018 90.0813 135.368 75.9149 135.652 61.5182L135.652 59.6639C135.652 36.4736 127.673 4.15009 114.598 4.13281C101.522 4.11554 93.4698 36.4563 93.4514 59.6235L93.4514 61.4836C93.7035 75.8746 97.0158 90.0467 103.165 103.05C90.2388 96.8362 76.14 93.4789 61.8149 93.191C40.8166 92.7821 16.2337 99.1512 8.25944 107.098C7.18246 107.968 6.3117 109.068 5.71592 110.317C5.12014 111.567 4.81076 112.938 4.81076 114.325C4.81076 115.713 5.12014 117.084 5.71592 118.333C6.3117 119.589 7.18246 120.689 8.25944 121.558C16.3082 129.505 40.8532 135.926 61.8149 135.575C76.1423 135.31 90.2474 131.97 103.184 125.774C96.9952 138.765 93.645 152.937 93.3592 167.34L93.3592 169.194C93.3592 192.384 101.337 224.725 114.413 224.742C127.489 224.76 135.559 192.419 135.578 169.235Z" fill="white" />
                <path id="Vector_2" d="M134.041 206.501C137.838 194.448 139.787 181.882 139.821 169.236L139.821 167.382C139.616 155.928 137.544 144.578 133.69 133.797C144.404 137.702 155.686 139.804 167.081 140.017C186.583 140.385 213.806 134.707 223.778 124.889C225.259 123.616 226.447 122.044 227.263 120.27C228.078 118.497 228.5 116.562 228.5 114.609C228.5 112.657 228.078 110.722 227.263 108.949C226.447 107.175 225.259 105.603 223.778 104.336C213.824 94.4943 186.62 88.7586 167.117 89.0926C155.722 89.2884 144.436 91.3673 133.708 95.2372C137.586 84.4627 139.677 73.1238 139.895 61.6698L139.895 59.8155C139.877 47.1694 137.952 34.6039 134.189 22.5337C129.35 7.68205 122.775 -4.62137e-06 114.612 -4.9782e-06C106.449 -5.33501e-06 99.8372 7.55538 94.9804 22.4992C91.1904 34.5521 89.2415 47.1176 89.1997 59.7579L89.1997 61.618C89.3887 73.0662 91.4539 84.4051 95.3127 95.1796C84.5939 91.2925 73.3147 89.1906 61.9221 88.9602C42.4194 88.5917 15.194 94.2697 5.22616 104.111C3.74243 105.378 2.55659 106.956 1.73739 108.73C0.92393 110.503 0.49998 112.433 0.49998 114.385C0.49998 116.343 0.92393 118.272 1.73739 120.046C2.55659 121.819 3.74243 123.397 5.22616 124.664C15.1768 134.5 42.3822 140.241 61.8849 139.907C73.2826 139.712 84.5703 137.627 95.2944 133.74C91.4161 144.52 89.3263 155.865 89.1074 167.324L89.1074 169.185C89.1263 181.825 91.0506 194.396 94.8137 206.46C99.6527 221.312 106.228 229 114.409 229C122.59 229 129.183 221.445 134.041 206.501ZM167.284 97.5579C191.57 97.1491 220.011 106.023 219.993 114.529C219.974 123.029 191.533 131.868 167.247 131.402C154.035 131.114 141.023 128.102 129.017 122.545C128.057 120.581 127.078 118.704 126.081 116.976L129.775 114.488L126.081 111.983C127.06 110.129 128.057 108.269 129.017 106.415C141.039 100.881 154.064 97.8861 167.284 97.6155L167.284 97.5579ZM97.7503 61.4107L97.7503 59.5563C97.7503 35.5484 106.394 8.33277 114.649 8.33277C122.904 8.33277 131.474 35.5886 131.455 59.5909L131.455 61.4509C131.167 74.742 128.168 87.8315 122.646 99.9132C120.688 100.881 118.823 101.883 117.105 102.867L114.612 99.153L112.119 102.867C110.364 101.865 108.517 100.881 106.578 99.9132C101.047 87.8257 98.0424 74.719 97.7503 61.4107ZM61.7743 131.292C37.4882 131.718 9.04716 122.827 9.06434 114.321C9.08154 105.822 37.5249 96.9993 61.8109 97.4657C75.0355 97.7479 88.0608 100.76 100.077 106.323C101.038 108.286 102.017 110.146 103.014 111.891L99.3205 114.396L103.014 116.901C102.035 118.761 101.038 120.616 100.077 122.47C88.0482 128.027 75.0092 131.027 61.7743 131.292ZM97.6214 169.202L97.6214 167.342C97.8998 154.051 100.892 140.961 106.412 128.879C108.37 127.912 110.235 127.019 111.953 125.943L114.446 129.657L116.939 125.943C118.694 126.945 120.541 127.929 122.48 128.897C127.99 140.984 130.963 154.085 131.215 167.382L131.215 169.236C131.215 193.244 122.572 220.477 114.316 220.477C106.061 220.477 97.6214 193.187 97.6214 169.202Z" fill="#131314" />
                <path id="Vector_3" d="M115.351 110.254C134.647 113.997 152.456 123.263 166.638 136.934C181.855 151.786 194.691 173.767 194.691 185.094C194.81 186.459 194.628 187.829 194.157 189.114C193.686 190.398 192.939 191.561 191.968 192.523C190.997 193.479 189.827 194.216 188.542 194.665C187.256 195.12 185.888 195.281 184.534 195.137C173.249 195.028 151.383 182.14 136.812 166.862C123.243 152.569 114.061 134.654 110.365 115.253L109.164 109.033L115.351 110.254Z" className={classNames(cls.secondSlide, { [cls.secondSlideActive]: getActiveSlides.includes(1) })} />
                <path id="Vector_4" d="M34.3696 43.7694C34.2894 42.4161 34.4841 41.0628 34.9407 39.7844C35.3978 38.506 36.1082 37.337 37.0282 36.3465C38.0353 35.4078 39.2212 34.6937 40.5135 34.233C41.8054 33.7723 43.1768 33.5823 44.5448 33.6687C55.8291 33.8012 77.6771 46.666 92.2485 61.9668C105.824 76.2484 115.007 94.1695 118.695 113.576L119.896 119.796L113.709 118.569C94.4145 114.826 76.6063 105.56 62.4222 91.8891C47.204 77.0374 34.3696 55.0565 34.3696 43.6197" className={classNames(cls.fourthSlide, { [cls.fourthSlideActive]: getActiveSlides.includes(3) })} />
                <path id="Vector_5" d="M34.2368 184.87C34.2368 173.543 47.167 151.453 62.3852 136.768C76.586 123.108 94.4181 113.871 113.727 110.18L119.914 108.977L118.695 115.173C114.974 134.614 105.73 152.553 92.0825 166.823C77.4922 182.008 55.607 194.913 44.3233 195.006C42.9685 195.144 41.5999 194.983 40.3155 194.528C39.0312 194.073 37.8625 193.341 36.8938 192.38C35.9245 191.418 35.1792 190.249 34.7123 188.965C34.2426 187.681 34.065 186.304 34.1853 184.945" className={cls.firstSlide} />
                <path id="Vector_6" d="M110.365 113.618C114.081 94.2115 123.305 76.3077 136.922 62.0607C151.512 46.8578 173.398 33.9525 184.682 33.8604C186.036 33.7222 187.405 33.8835 188.689 34.3384C189.973 34.7934 191.142 35.5247 192.111 36.4864C193.08 37.4481 193.825 38.6171 194.294 39.9013C194.762 41.1855 194.942 42.5561 194.82 43.9209C194.82 55.2482 181.893 77.3386 166.693 92.0232C152.484 105.683 134.646 114.914 115.333 118.611L109.164 119.815L110.365 113.618Z" className={classNames(cls.thirdSlide, { [cls.thirdSlideActive]: getActiveSlides.includes(2) })} />
                <path id="Vector_7" d="M114.502 141.635C119.344 152.024 125.851 161.549 133.764 169.818C147.283 183.944 170.517 199.262 184.478 199.412C186.395 199.568 188.324 199.303 190.131 198.646C191.939 197.984 193.584 196.942 194.954 195.583C196.325 194.229 197.388 192.588 198.073 190.786C198.757 188.977 199.046 187.042 198.921 185.113C198.921 171.079 183.703 147.595 169.593 133.873C161.38 125.903 151.921 119.343 141.595 114.454C151.942 109.605 161.421 103.069 169.648 95.1108C183.795 81.4109 199.068 57.9788 199.087 43.9276C199.211 41.9984 198.923 40.0635 198.239 38.2553C197.556 36.447 196.495 34.8116 195.127 33.4525C193.76 32.0935 192.118 31.0454 190.313 30.3774C188.507 29.7151 186.58 29.4445 184.663 29.5942C170.701 29.7036 147.431 45.0045 133.894 59.096C125.962 67.3482 119.435 76.8557 114.576 87.2386C109.738 76.8442 103.23 67.3251 95.313 59.0556C81.794 44.9296 58.5608 29.5942 44.5989 29.4618C42.6821 29.3063 40.7539 29.5654 38.9465 30.2277C37.1385 30.8899 35.4938 31.9322 34.1224 33.2913C32.7532 34.6446 31.6877 36.2801 31.006 38.0883C30.3186 39.8965 30.0321 41.8314 30.1582 43.7606C30.1582 57.7945 45.3746 81.2784 59.5026 95.0014C67.7015 102.943 77.1486 109.473 87.4642 114.328C77.1332 119.194 67.6677 125.736 59.4476 133.688C45.2824 147.388 30.0092 170.82 29.992 184.871C29.8717 186.801 30.1582 188.736 30.8456 190.538C31.5273 192.346 32.5871 193.982 33.9563 195.341C35.3237 196.7 36.9644 197.748 38.7683 198.41C40.5723 199.078 42.4977 199.349 44.4145 199.205C58.3764 199.072 81.6467 183.795 95.1836 169.703C103.115 161.48 109.642 151.995 114.502 141.635ZM163.702 140C178.347 154.241 190.462 175.18 190.444 185.096C190.572 186.685 190.067 188.263 189.04 189.478C183.057 195.473 156.72 181.497 139.877 163.916C130.708 154.304 123.609 142.896 119.026 130.4C119.729 128.344 120.356 126.317 120.873 124.371L125.232 125.223L124.383 120.841C126.322 120.305 128.335 119.689 130.384 118.986C142.809 123.616 154.151 130.769 163.702 140ZM139.97 65.0159C156.85 47.4519 183.204 33.4525 189.188 39.5452C190.215 40.7603 190.72 42.3382 190.592 43.9276C190.592 53.8383 178.421 74.7653 163.738 88.9663C154.2 98.1629 142.886 105.298 130.496 109.928C128.427 109.22 126.414 108.586 124.493 108.068L125.343 103.668L120.984 104.521C120.449 102.666 119.821 100.57 119.137 98.4912C123.726 86.0121 130.817 74.6214 139.97 65.0159ZM65.3573 88.8742C50.712 74.6329 38.5226 53.6885 38.5226 43.7778C38.3942 42.1884 38.8989 40.6105 39.9267 39.3955C45.9286 33.3834 72.2644 47.3771 89.0894 64.9583C98.2593 74.5696 105.358 85.9776 109.94 98.4682C109.238 100.53 108.629 102.557 108.093 104.503L103.735 103.634L104.584 108.033C102.645 108.569 100.65 109.185 98.5818 109.888C86.1936 105.24 74.8858 98.0881 65.3573 88.8742ZM39.8711 189.329C39.363 188.713 38.982 188.004 38.7506 187.238C38.5191 186.472 38.4418 185.666 38.5226 184.871C38.5226 174.961 50.6937 154.034 65.3757 139.833C74.9144 130.636 86.2285 123.501 98.619 118.871C100.688 119.579 102.701 120.213 104.621 120.731L103.771 125.114L108.13 124.256C108.666 126.208 109.294 128.229 109.977 130.308C105.35 142.77 98.2278 154.143 89.0522 163.726C72.2094 181.422 45.9103 195.347 39.8711 189.329Z" fill="#131314" />
                <path id="Vector_8" d="M85.8754 114.327C85.8823 108.649 87.5636 103.104 90.7064 98.3873C93.8491 93.6709 98.3117 90.0027 103.531 87.8316C108.75 85.6664 114.491 85.1078 120.027 86.2192C125.564 87.3306 130.648 90.0718 134.636 94.0856C138.625 98.1051 141.339 103.219 142.436 108.787C143.533 114.356 142.962 120.126 140.797 125.367C138.632 130.613 134.97 135.087 130.273 138.237C125.576 141.387 120.055 143.069 114.409 143.063C106.836 143.052 99.5789 140.017 94.2289 134.627C88.8795 129.242 85.8754 121.94 85.8754 114.327Z" fill="#FFDE0D" />
                <path id="Vector_9" d="M138.733 114.453C138.73 119.284 137.3 124.012 134.626 128.026C131.951 132.04 128.152 135.172 123.709 137.015C119.265 138.864 114.377 139.342 109.662 138.392C104.948 137.447 100.619 135.115 97.2232 131.688C93.8279 128.268 91.5175 123.914 90.5855 119.169C89.6534 114.43 90.1409 109.518 91.9867 105.055C93.8325 100.592 96.9534 96.7792 100.955 94.1014C104.956 91.4237 109.658 89.9956 114.466 90.0013C120.908 90.0128 127.084 92.5927 131.634 97.1767C136.185 101.766 138.738 107.98 138.733 114.453ZM147.247 114.453C147.258 107.928 145.343 101.542 141.745 96.1112C138.146 90.6808 133.025 86.4424 127.031 83.9374C121.036 81.4323 114.436 80.7701 108.067 82.0313C101.698 83.2982 95.8449 86.4367 91.2488 91.0436C86.6527 95.6563 83.5203 101.53 82.2474 107.928C80.9745 114.332 81.6184 120.966 84.0983 126.995C86.5777 133.03 90.7808 138.184 96.1766 141.818C101.572 145.446 107.918 147.387 114.41 147.387C123.106 147.387 131.447 143.92 137.603 137.747C143.759 131.573 147.228 123.194 147.247 114.453Z" fill="#131314" />
              </g>
            </svg>
          </motion.div>
        </div>
        <div>
          <Swiper
            modules={[A11y, Pagination, Navigation, Autoplay]}
            slidesPerView={isMobile ? 1 : 2}
            centeredSlides
            autoplay={{ delay: 2000 }}
            navigation
            pagination={{ clickable: true }}
            loop
            spaceBetween={20}
            onSlideChange={handleSwipe}
            grabCursor
          >
            {slides.map((slide) => (
              <SwiperSlide key={slide.id}>
                {({ isActive }) => (
                  <div className={classNames(cls.slideContainer, { [cls.notActive]: !isActive })}>
                    <span className={classNames(cls.slideTitle, {}, [cls[slide.color]])}>{slide.titleText}</span>
                    <img className={cls.slideImg} src={slide.img} alt={slide.titleText} />
                  </div>
                )}
              </SwiperSlide>
            ))}
          </Swiper>
        </div>
      </div>
      <svg className={classNames('curves', {}, [cls.greenCurve])} xmlns="http://www.w3.org/2000/svg" width="461" height="936" viewBox="0 0 461 936" fill="none">
        <path d="M-69.477 926.003C425.504 862.028 609.018 490.537 298.138 575.139C2.44761 655.608 94.1142 206.707 -58.4884 355.724C-156.147 451.088 29.2998 547.144 137.269 419.534C312.623 212.28 27.9891 -30.9691 -30.5179 15.8564" stroke="#ABC704" stroke-width="20" stroke-linecap="round" />
      </svg>
    </div>
  )
}